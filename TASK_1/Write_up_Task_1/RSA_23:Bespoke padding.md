### Crypto

---

**_TASK:_**

Been cooking up my own padding scheme, now my encrypted flag is different everytime!

*Connect at socket.cryptohack.org 13386*

Challenge files:
  - 13386.py

---

Ở bài này, ta có cách pad là thêm với hệ số a, b. Có:
$$(a_1 * m + b_1) ^ {e} = c_1 \pmod{n} \quad \to \quad p_1 \equiv (a_1 * m + b_1) ^ {e} - c_1 \equiv 0 \pmod{n}$$
$$(a_2 * m + b_2) ^ {e} = c_2 \pmod{n} \quad \to \quad p_2 \equiv (a_2 * m + b_2) ^ {e} - c_2 \equiv 0 \pmod{n}$$

Vì cả hai hệ có chung một nghiệm là $m$ nên khi lấy $GCD(p_1, p_2)$ thì ta sẽ có được m. Để lấy được gcd của đa thức ta có thể sử dụng Euclidean algorithm.
$$a * p_1 + b * p_2 = gcd(p_1, p_2) \quad \forall a, b \in R$$

Ở đây do là đa thức nên $gcd(p_1, p_2)$ là đa thức dạng $k_1 * x + k_2$ nên từ đó $m = x = (- k_1) / k_2$ (do ở đây m > 0 nên m = - x)
Lưu ý: ở đây các phép toán thực hiện trên vành $Z_n$ nên $x = - k_1 * (k_2 ^ {-1}) \pmod{n}$

```sage
a_1 = 17162007231311912596881232614414284740571306728000523153153762846286545376074086012523654088446930792099462138735407742618628486664616006556851336426277314769301631598994971630457155637948283420221868485142883718922854558204865140809223277632852739351273350855924655979528734043199315512490555039570608761303645621185410385318749549324039842614901771897248350574623112681957384483554126304956327481093113433223442718297718702324795580798509598781274423356651272077472783603775587956523948669656072595440147076072736371676165555415142029258405092390871403879531839340217564187257509039855732240398145484544346605825506
b_1 = 12728910801852701298970809601109654524922491804041092010050434271122411766892987878597259627022767997866889151096975076389054696347995631307043411737023346783907065169772873772265172639142174460272364031325439484800217565494390027358691863318312697896769976927921249381343221246914349154799903238818149231579375197882763299216957397563511535279541429521152771173889423075641631239264839901607264751672843333735891164084082700604529117503741410949551866711349282534827298443613070692341147302722062943746024874343442679263468809732766897329841510516420385829746157443521698397226391525213289197970493179369331127059699

a_2 = 7488481819371669186210556731106084122601862973062938343532438652077141932062154868189163309965447336722662602132566350094595550649262304111402632924611911919636242609617270988265066473854643941862502258088420468554283963747918237295579695891127184572342325948431745468930563458404711584023593078020031521258331655349905997812925292545296252277231587404242237406265276849813090884450895530156461008371312542853805271829141000531570843025492421416129659107165635466203688812254236880831445431721851270031246629651167948118778931356363926202461466490245912711233102946022205864153127202221669473407951943610758170718562
b_2 = 1943770981482450073372224968709345970535303551580082475401088843685495743786566631785398705868361931061287668750465547577225848297341413690238898566011471181061250598347256524653388630468415993603033410038149592691810101926763487440228792014681213054222791454814004946620879736626796823499853048753392148956522449179830411900541047426303444742400273278966118487916444005433251346408519079171489153551215730046825406936819496114873154050327610716827758805256831085717999851855878885776527749682831003316494376794185874654378057052558863037576083182061344248005831163603448805703272282330713377151035574579156369487350

e = 11
c_1 = 3722276538708576810135582049777478248813340811432584756132467807064633144228058244261014027805462706379206421557294827128333377534887742462848024475241771510404261716339105324995260590909819718947663657228556962878878019169666879948273245689060970205860940982267042612867030847164965306043093208403603388880717553528316616667314814082751655523995779195751728288849716760427237925104954249896401606687006993615133513456077317795932106263974234404342316111931833517106548058290087117176907887836047913996357797063110535413852432939928290238334679366552736667950604051935941076143600517086375128438282098905022393599577
c_2 = 24031855943401774334767271017064337592781917047838509046509038306915351130601883194171581570374966372572278802999431862592222537224061000493187294948998032678501284058090089782688485192579426690753106229383401152644971416324031438039461297772337428082734481347872570843248010236422203682931999398860551134846190319006024643541735887435306985424284437374197169517324890453212252847676706478608223107834689620572477322020606870103876417365657920440059012016776754883595463091476995948422576367220068209521215758204094833029612726587460062816060758843102652423359224636760685584592759559843623704703674396313561689400979

n = 24129274210542368779384136015071771494880097975591074545545673044790048274189069595459582260597453834458319903764639472243823895416855121993241499799234118491832840420755618977980472504718049617831316608135748918826935271899731685555927104413536534375298620741901072221797604839844921461052118301676173630376495811234070526248256879213740325006261231473679475014731322352117658991110338372805266727231433733705638249922274980480062560321384218681304616595672366936750515333394418888537608681967082453279049944482384051108141905460148368996896989298035169802747204154144677474269357629045746866037221439287152349065673

p.<x> = PolynomialRing(Zmod(n))

p1 = (a_1 * x + b_1) ** e - c_1
p2 = (a_2 * x + b_2) ** e - c_2

def gcd(a, b):
    while b:
        a, b = b, a % b
    return a, b
print(gcd(p1, p2))


```

từ đó có hệ : 
```
15068000529051858974078233360898083852193818548072020340539084206583920319536386103716279519612268531398253302027872144330590930409824142872801556648551378866011115469506758470874253127360289321588674927089408367112780137432977332580699968774082872839181756463593991599269897128345681118315607735333750877468017759361005970417195675538921140431599420640959687475306213540454503733372342073925895942554673306262669750236369225709140649164832667125240774427232023619752197599028617557973643697674715466931431141205127136887322106947602748705840849645592120252840202045061066517237362273475062572275482119401944734753348*x + 7780560773438608891664556743027867458399219523568634027517431612400044366352854217652618783450042970363103754853449465567768036765889830250341501857597567402217729624339502308105398319915637254989825849785954203481735887243614012485303719941404622682958459963328962178414960489403194324328015561647601260871762399397363709738312979828996153827239443621336934971902983562174912371837748010589880024241507399091503913428491088233458700565967923681221645748846274764417222911467652734779124555323943779689160138229072720450992403342875984393985654942966227066291733186007175014988487820487424927296366006117445400610137
```

```python
n = 24129274210542368779384136015071771494880097975591074545545673044790048274189069595459582260597453834458319903764639472243823895416855121993241499799234118491832840420755618977980472504718049617831316608135748918826935271899731685555927104413536534375298620741901072221797604839844921461052118301676173630376495811234070526248256879213740325006261231473679475014731322352117658991110338372805266727231433733705638249922274980480062560321384218681304616595672366936750515333394418888537608681967082453279049944482384051108141905460148368996896989298035169802747204154144677474269357629045746866037221439287152349065673

a = 15068000529051858974078233360898083852193818548072020340539084206583920319536386103716279519612268531398253302027872144330590930409824142872801556648551378866011115469506758470874253127360289321588674927089408367112780137432977332580699968774082872839181756463593991599269897128345681118315607735333750877468017759361005970417195675538921140431599420640959687475306213540454503733372342073925895942554673306262669750236369225709140649164832667125240774427232023619752197599028617557973643697674715466931431141205127136887322106947602748705840849645592120252840202045061066517237362273475062572275482119401944734753348
b = 7780560773438608891664556743027867458399219523568634027517431612400044366352854217652618783450042970363103754853449465567768036765889830250341501857597567402217729624339502308105398319915637254989825849785954203481735887243614012485303719941404622682958459963328962178414960489403194324328015561647601260871762399397363709738312979828996153827239443621336934971902983562174912371837748010589880024241507399091503913428491088233458700565967923681221645748846274764417222911467652734779124555323943779689160138229072720450992403342875984393985654942966227066291733186007175014988487820487424927296366006117445400610137
from Crypto.Util.number import long_to_bytes

print(long_to_bytes(-(b * pow(a, -1, n)) % n))

```

> crypto{linear_padding_isnt_padding}
